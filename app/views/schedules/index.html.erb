<% in_progress_area do %>
  <% if @in_progress.count > 0 %>
  <%= render :partial => 'shared/schedule_list', :locals => {:list => @in_progress, :title => "Happening Now", :item_partial => 'shared/schedule_item'} %>
  <% end %>
<% end %>

<% upcoming_area do %>
  <% if @upcoming.count > 0 %>
  <%= render :partial => 'shared/schedule_list', :locals => {:list => @upcoming, :title => "Upcoming", :item_partial => 'shared/schedule_item'} %>
  <% end %>
<% end %>

<% admin_area do %>
  <h3>Schedule Admin - <span class="signout"><%= link_to "Sign Out", destroy_user_session_path, :method => :delete %></span></h3>
 
  <table>
    <tr class="child">
      <td colspan="9"><%= link_to 'New Parent Item', new_schedule_path %> <%= submit_tag "Toggle Past", :type => 'button', :id => 'past_button' %> <%= submit_tag "Toggle Present #{current_time.to_date.strftime("%m/%d/%Y")}", :type => 'button', :id => 'present_button' %> <%= submit_tag "Toggle Future", :type => 'button', :id => 'future_button' %></td>
    </tr>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Start</th>
      <th>End</th>
      <th>Order</th>	  
      <th colspan="4">Functions</th>
    </tr>
 
    <% @parents.each do |parent| %>
	  <%= content_tag :tr, :class => "parent #{past_present_future(parent.start)}" do  %>
        <td><%= parent.id %></td>
        <td><%= parent.schedulable.name %></td>
        <td><%= display_time(parent.start) %></td>
        <td><%= display_time(parent.end) %></td>
        <td><%= parent.order %></td>
        <td><%= link_to 'Show', parent %></td>
        <td><%= link_to 'Edit', edit_schedule_path(parent) %></td>
        <td><%= link_to 'Add Child', new_child_path(parent) %></td>
        <td><%= link_to 'Remove', parent, :confirm => 'Are you sure?', :method => :delete %></td>
	  <% end %>
      <% parent.children.each do |child| %>
	  <%= content_tag :tr, :class => "child parent #{past_present_future(child.start)}" do  %>
          <td><%= child.id %></td>
          <td style="padding-left: 50px;"><%= child.schedulable.name %></td>
          <td><%= display_time(child.start) %></td>
          <td><%= display_time(child.end) %></td>
          <td><%= child.order %></td>
          <td><!--<%= link_to 'Show', child %>--></td>
          <td><%= link_to 'Edit', edit_schedule_path(child) %></td>
          <td></td>
          <td><%= link_to 'Remove', child, :confirm => 'Are you sure?', :method => :delete %></td>
	      <% end %>
      <% end %>
    <% end %>
  </table>

	<script type="text/javascript">
	    $(document).ready(function(){
			$("#past_button").click(function(){
				$('.past').toggle();
				return false;
			});
			$("#present_button").click(function(){
				$('.present').toggle();
				return false;
			});
			$("#future_button").click(function(){
				$('.future').toggle();
				return false;
			});
	    });
	</script>
<% end %>


